(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{123:function(e,t,n){e.exports=n(267)},267:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),l=n(26),r=n.n(l),s=n(27),i=n(2),c=n(8),u=n(4),d=n(3),m=n(5),h=" https://bender-app.herokuapp.com/",v={URLS:{BASE_URL:h,AUTH:{PHONE:h+"requestCode",GET_TOKEN:h+"getToken/"},UPDATES:h+"updates",PROFILE:h+"profile",USER:h+"user/",MATCH:h+"user/matches/",SEND_MESSAGE:h+"postMessage",SEND_LOCATION:h+"location",NEW_FRIENDS:h+"new-friends",SEND_SEEN:h+"seen/",FAST_MATCH:h+"fast-match",LIKE:h+"like/",PASS:h+"pass/",STORAGE:h+"storage/",STORAGE_TOKEN:h+"storage/token/",STORAGE_BOOKMARKS:h+"storage/bookmarks/",STORAGE_SETTINGS:h+"storage/settings/"},UPDATE_POLL_INTERVAL:2e4,LOCAL_CASH_VAR_NAME:"__TnDr__",AUTH_HEADER_NAME:"X-Auth-Token",PHONE_HEADER_NAME:"phone-number",VERSION:"1.30"},g=n(116),f=n.n(g),p=new(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).execute=function(e,t,n,a){return f()({method:e,url:t,data:n,headers:a})},n.doPost=function(e,t,a){return n.execute("post",e,t,n.getHeaders(a))},n.doPut=function(e,t,a){return n.execute("put",e,t,n.getHeaders(a))},n.doGet=function(e,t){return n.execute("get",e,{},n.getHeaders(t))},n.doDelete=function(e,t){return n.execute("delete",e,{},n.getHeaders(t))},n.getHeaders=function(e){var t=v.AUTH_HEADER_NAME,n=v.PHONE_HEADER_NAME;return e||(e={}),b[n]&&(e[n]=b[n]),b[t]&&(e[t]=b[t]),e},n}return Object(m.a)(t,e),t}(o.a.Component)),b=new(function(e){function t(e){var n,a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).persistAll=function(e,t){p.doPost(v.URLS.STORAGE+e,{json:JSON.stringify(t)},{}).catch((function(e){console.error(e)}))},a.loadAll=function(e){return p.doGet(v.URLS.STORAGE+e,{})},a.getPhone=function(){return a[v.PHONE_HEADER_NAME]},a.setPhone=function(e){a[v.PHONE_HEADER_NAME]=e},a.getToken=function(){return a[v.AUTH_HEADER_NAME]},a.setToken=function(e){a[v.AUTH_HEADER_NAME]=e},a.getSettings=function(){return a.settings},a.setSettings=function(e){a.settings=e},a.persistSettings=function(e){p.doPut(v.URLS.STORAGE_SETTINGS+a.getPhone(),{json:JSON.stringify(e)})},a.persistBookmarks=function(e){p.doPost(v.URLS.STORAGE_BOOKMARKS+this.getPhone(),{json:JSON.stringify(e)},{}).then((function(e){console.log(e)})).catch((function(e){console.error(e)}))},a[v.PHONE_HEADER_NAME]=null,a[v.AUTH_HEADER_NAME]=null,a.settings={bgColor:"bg-dark",textColor:"text-white"},a.bookmarks=[],a.cashStructureTemplate=(n={settings:a.settings},Object(s.a)(n,v.AUTH_HEADER_NAME,{token:a[v.AUTH_HEADER_NAME]}),Object(s.a)(n,"bookmarks",a.bookmarks),n),a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"persistToken",value:function(e){p.doPut(v.URLS.STORAGE_TOKEN+this.getPhone(),{json:JSON.stringify({token:e})})}},{key:"getBookmarks",value:function(){return this.bookmarks}},{key:"setBookmarks",value:function(e){this.bookmarks=e}},{key:"getBookmarksAsObject",value:function(){return this.bookmarks.reduce((function(e,t,n){return e[t]=n,e}),{})}}]),t}(o.a.Component)),E=new(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).applyDesignSettings=function(){var e,t=n.getSetting("textColor")||(null===(e=n.textColors[0])||void 0===e?void 0:e.class);t&&(console.log(t),n.applyClass(document.body,n.textColors,t));var a=n.getSetting("bgColor")||n.bgColors[0].class;a&&n.applyClass(document.body,n.bgColors,a)},n.persistSetting=function(e,t){var n=b.getSettings();n||(n={},b.setSettings(n)),n[e]=t,b.persistSettings(n)},n.getSetting=function(e){var t=b.getSettings();return null===t||void 0===t?void 0:t[e]},n.applyClass=function(e,t,n){t.forEach((function(t){e.classList.remove(t.class)})),e.classList.add(n)},n.getInputStyleClasses=function(){return"form-control "+(n.getSetting("textColor")||" ")+" "+(n.getSetting("bgColor")||"")},n.textColors=[{name:"Gray",class:"text-muted"},{name:"White",class:"text-white"},{name:"Dark",class:"text-dark"},{name:"Black",class:"text-body"}],n.bgColors=[{name:"Gray",class:"bg-secondary"},{name:"Dark",class:"bg-dark"},{name:"Light",class:"bg-light"}],n.updatePollInterval=v.UPDATE_POLL_INTERVAL,n.isToShowPhotos=!0,n}return Object(m.a)(t,e),t}(o.a.Component)),k=new(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).add=function(e){if(!e||!e.state)throw new Error("Not allowed 'null' values for 'bean': "+e+" !");var t=e.state.beanId||e.props.beanId;if(!t)throw new Error("Not allowed 'null' value for 'beanId' "+t+" !");n.context[t]&&console.warn("Bean with 'beanId': "+t+"is already registered under BeanContextAware!"),n.context[t]=e},n.get=function(e){if(!e)throw new Error("Not allowed 'null' value for 'beanId' "+e+" !");return n.context[e]},n.remove=function(e){if(!e)throw new Error("Not allowed 'null' value for 'bean' "+e+" !");if("string"!==typeof e){var t=e.state.beanId||e.props.beanId;delete n.context[t]}else delete n.context[e]},n.context={},n}return Object(m.a)(t,e),t}(o.a.Component)),O=n(12),S=n(270),y=Object(O.b)({form:S.a}),j=(window.devToolsExtension?window.devToolsExtension()(O.c):O.c)(y),_=[],C=function(e){for(_.push(e);_.length>0;){_.shift()()}};j.getStore=function(){return C((function(){})),j},j.getMatchById=function(e){var t,n,a;if(!e)throw new Error("'id' is not allowed to be: "+e);for(var o=(null===(t=j.getStore())||void 0===t?void 0:null===(n=t.update)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.matches)||[],l=0;l<o.length;l++)if(e===o[l]._id)return o[l];return null},j.addToStore=function(e,t){if(!e||"string"!=typeof e)throw new Error("Only objects of type 'string' are allowed!");C((function(){j[e]=t}))};var N=j,w=new(function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).checkIfLogged=function(e,t,a){p.doGet(v.URLS.PROFILE,e).then((function(e){N.addToStore("profile",e),t(),n.getUpdates(n.getLastActivityDate()),n.startUpdatePoll(E.updatePollInterval)})).catch((function(e){console.error(e),a()}))},n.mergeUpdates=function(e,t){for(var a=t.data.matches,o=0;o<a.length;o++){var l,r=a[o],s=e.getMatchById(r._id);if(s){for(var i=r.messages,c=i.length,u=s.messages.length-1;0<=c||0<=u;u--,c--)s.messages[u]&&!s.messages[u]._id&&s.messages.splice(u,1);s.messages=s.messages.concat(i),s.seen||(s.seen={});var d=null===r||void 0===r?void 0:null===(l=r.seen)||void 0===l?void 0:l.last_seen_msg_id;d&&(s.seen.last_seen_msg_id=d),s.last_activity_date=(null===r||void 0===r?void 0:r.last_activity_date)||s.last_activity_date||n.BASE_DATE}else e.getStore().update.data.matches.push(r),n.addToUnreadMessagesBadge(r)}},n.markLastUnreadMessages=function(e,t){for(var a,o=null===t||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.matches,l=0;l<(null===o||void 0===o?void 0:o.length);l++){var r,s,i,c=o[l],u=e.getMatchById(c._id),d=null===c||void 0===c?void 0:null===(r=c.seen)||void 0===r?void 0:r.last_seen_msg_id,m=(null===u||void 0===u||(null===(s=u.seen)||void 0===s||s.last_seen_msg_id),null===e||void 0===e?void 0:null===(i=e.profile)||void 0===i?void 0:i.data);if(m&&m._id)for(var h=c.messages,v=h.length-1;0<=v;v--){var g=h[v];if(g.from&&m._id!==g.from){g._id===d&&d||n.addToUnreadMessagesBadge(u);break}}}},n.addToUnreadMessagesBadge=function(e){var t=k.get("header1");t&&t.addMsgMatch(e)},n.getUpdates=function(e){var t=k.get("header1"),a=k.get("chat1"),o={last_activity_date:e};p.doPost(v.URLS.UPDATES,o,{}).then((function(e){N.update?n.mergeUpdates(N,e):N.addToStore("update",e),n.markLastUnreadMessages(N,e),n.last_activity_date=e.data.last_activity_date,a&&a.triggerRenderFunc(),t&&t.changeButtonVisibility({isVisible:!0}),n.exceptionCount=0})).catch((function(e){console.error(e),t&&t.changeButtonVisibility({isVisible:!1}),n.isToStopUpdatePoll(e)&&n.stopUpdatePoll(),n.exceptionCount++}))},n.isToStopUpdatePoll=function(e){return n.exceptionCount>2},n.startUpdatePoll=function(e){e?(n.stopUpdatePoll(),n.pollInterval=e,n.pollIntervalObj=setInterval((function(){n.getUpdates(n.getLastActivityDate())}),e)):console.error("error null val for 'seconds'")},n.getLastActivityDate=function(){return n.last_activity_date},n.stopUpdatePoll=function(){n.pollIntervalObj&&clearTimeout(n.pollIntervalObj)},n.state={},n.BASE_DATE="1984-08-01T00:00:00.000Z",n.last_activity_date=n.BASE_DATE,n.exceptionCount=0,n}return Object(m.a)(t,e),t}(o.a.Component)),M=new(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).saveBookmark=function(e){var t=b.getBookmarks();-1===t.indexOf(e)&&(t.push(e),b.persistBookmarks(t))},n.removeBookmark=function(e){for(var t=b.getBookmarks(),n=0;n<t.length;n++){var a=t[n];if(e&&a===e){t.splice(n,1),b.persistBookmarks(t);break}}},n.saveAllByPhone=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.getPhone();b.persistAll(e,b.cashStructureTemplate)},n.getOne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b.getPhone(),t=p.doGet(v.URLS.STORAGE+e,{});t.then((function(e){console.log(e)})).catch((function(e){console.error(e)}))},n}return Object(m.a)(t,e),t}(o.a.Component)),T=n(13),P=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={hits:[],isLoading:!1,error:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Welcome"),o.a.createElement(T.b,{to:"/phone"},"  Login with phone"),o.a.createElement("p",null),o.a.createElement(T.b,{to:"/phone-token"},"  Login with phone and token"))}}]),t}(a.Component),A=n(120),x=n.n(A),I=n(269),R=n(268),B=n(39),H=function(e){var t=e.input,n=e.label,a=e.type,l=(e.value,e.placeholder),r=e.meta,s=r.touched,i=r.error;return o.a.createElement("div",null,o.a.createElement("label",null,n),o.a.createElement("div",null,o.a.createElement("input",Object.assign({className:"form-control"},t,{placeholder:l,type:a})),s&&i&&o.a.createElement("span",null,i),o.a.createElement("p",null)))},D=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.options,t=e.handleSubmit,n=e.fields,a=Object(R.a)({form:"RenderFieldWrapped"})((function(){return o.a.createElement("div",null,o.a.createElement("form",{onSubmit:t},n.map((function(e){var t;return(t=e).noCash&&(t.name=x()()),o.a.createElement("div",{key:e.name},o.a.createElement(I.a,{name:e.name,onChange:e.onChange,component:H,type:"input",placeholder:e.placeholder,label:e.label}),o.a.createElement("p",null))})),o.a.createElement("input",{className:"btn btn-primary",type:"submit",value:"Submit"})))}));return o.a.createElement("div",null,o.a.createElement(B.a,{store:N},o.a.createElement(a,{options:e})))}}]),t}(o.a.Component),F=n(30),U=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){n.state.phone=e.target.value},n.phoneNumAuth=function(e){var t=this;p.doPost(v.URLS.AUTH.PHONE,{phone:e},{}).then((function(){b.setPhone(e),t.props.history.push("/confirm-token")})).catch((function(e){b.setPhone(null),console.error(e)}))},n.ifNotLogged=function(e){b.setToken(null),n.phoneNumAuth(e)},n.handleSubmit=function(e){e.preventDefault();var t=n.state.phone,a=b.loadAll(t);b.setPhone(t),a.then((function(e){var a,o,l,r;console.log(null===e||void 0===e?void 0:e.data);var s=null===e||void 0===e?void 0:null===(a=e.data)||void 0===a?void 0:a.settings;s&&(b.setSettings(s),E.applyDesignSettings());var i=null===e||void 0===e?void 0:null===(o=e.data)||void 0===o?void 0:o.bookmarks;i&&b.setBookmarks(i);var c=null===e||void 0===e?void 0:null===(l=e.data)||void 0===l?void 0:null===(r=l[v.AUTH_HEADER_NAME])||void 0===r?void 0:r.token;n.processAuth(c,t)})).catch((function(e){console.error(e)}))},n.processAuth=function(e,t){e?window.confirm("A session with this phone numer: "+t+" already exists.\nUse current session?")?(console.log("use current session:"),b.setToken(e),w.checkIfLogged({},(function(){n.props.history.push("/user")}),(function(){n.ifNotLogged(t)}))):n.phoneNumAuth(t):(b.persistAll(t,b.cashStructureTemplate),n.phoneNumAuth(t))},n.state={phone:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={handleSubmit:this.handleSubmit,fields:[{name:"Phone number",label:"Phone number",placeholder:"Please, fill in ur phone number",onChange:this.handleChange}]};return o.a.createElement("div",null,o.a.createElement(D,{options:e}))}}]),t}(o.a.Component),L=Object(F.f)(U),G=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){n.state.phone=e.target.value},n.handleChangeToken=function(e){n.state.token=e.target.value},n.doAuth=function(e,t){var n=this,a=Object(s.a)({},v.AUTH_HEADER_NAME,e);w.checkIfLogged(a,(function(){b.setToken(e),b.persistToken(e),n.props.history.push("/user")}),(function(){window.alert("The provided token: "+e+" is expired... phone: "+t),n.props.history.push("/phone-token")}))},n.handleSubmit=function(e){e.preventDefault();var t=n.state.phone,a=n.state.token,o=b.loadAll(t);b.setPhone(t),o.then((function(e){var o,l,r=null===e||void 0===e?void 0:null===(o=e.data)||void 0===o?void 0:o.settings;r&&(b.setSettings(r),E.applyDesignSettings());var s=null===e||void 0===e?void 0:null===(l=e.data)||void 0===l?void 0:l.bookmarks;s&&b.setBookmarks(s),n.doAuth(a,t)})).catch((function(e){console.error(e)}))},n.state={phone:"",token:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={handleSubmit:this.handleSubmit,fields:[{name:"Phone number",label:"Phone number",placeholder:"phone number..",onChange:this.handleChange},{name:"X-token",label:"X-token",placeholder:"auth token..",noCash:!0,onChange:this.handleChangeToken}]};return o.a.createElement("div",{autoComplete:"new-password"},o.a.createElement(D,{autoComplete:"new-password",options:e}))}}]),t}(o.a.Component),V=Object(F.f)(G),W=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e){n.state.confirmToken=e.target.value},n.handleSubmit=function(e){e.preventDefault();var t=b.getPhone();if(!t)throw new Error("CashService[Const.PHONE_HEADER_NAME] is not allowed to be "+t);var a=n.props.history;p.doGet(v.URLS.AUTH.GET_TOKEN+n.state.confirmToken+"/"+t).then((function(e){if(console.log(e),e&&200===e.status&&e.data){var t=e.data[v.AUTH_HEADER_NAME],n=Object(s.a)({},v.AUTH_HEADER_NAME,t);w.checkIfLogged(n,(function(){b.setToken(t),b.persistToken(t),a.push("/user")}),(function(){a.push("/phone")}))}})).catch((function(e){console.log(e)}))},n.state={confirmToken:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={handleSubmit:this.handleSubmit,fields:[{name:"Confirmation code",label:"Confirmation code",placeholder:"confirmation code...",noCash:!0,onChangeFun:this.handleChange}]};return o.a.createElement("div",null,o.a.createElement(D,{options:e}))}}]),t}(o.a.Component),K=Object(F.f)(W),z=n(121),J=n.n(z),q=(n(34),n(15)),X=n.n(q),Z=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).doChangeState=function(e){n.changeHandler(e),n.setState({condition:e.target.checked})},n.state={condition:e.condition},n.changeHandler=e.changeHandler,n.defaultChecked=e.defaultChecked,n.label=e.label,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"form-check"},o.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:this.state.condition,onChange:this.doChangeState}),o.a.createElement("label",{className:"form-check-label"}," ",this.label," "))}}]),t}(o.a.Component);var $=function(e){var t,n,a,l,r,s=e.person;if(!s)return o.a.createElement("div",null," ");var i=s.pos_info&&s.pos_info.country?s.pos_info.country.name:"",c=s.birth_date?s.birth_date.substring(0,4):"",u=s.pos_info&&s.pos_info.city?s.pos_info.city.name:"";return s.jobs=(null===(t=s.jobs)||void 0===t?void 0:null===(n=t[0])||void 0===n?void 0:null===(a=n.title)||void 0===a?void 0:a.name)||"",s.schools=(null===(l=s.schools)||void 0===l?void 0:null===(r=l[0])||void 0===r?void 0:r.name)||"",o.a.createElement("div",{className:"text-justify text-wrap"},s.name?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Name:  ")," ",s.name," "):null,s.birth_date?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Date of Birth:  ")," ",c," "):null,s.distance_mi?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Distance (miles):  ")," ",s.distance_mi," "):null,u?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Location:  ")," ",u,", ",i,"  "):null,s.bio?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Bio:  ")," ",s.bio," "):null,s.jobs?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Job:  ")," ",s.jobs," "):null,s.schools?o.a.createElement("div",null," ",o.a.createElement("span",{className:"font-weight-bold"},"Schools:  ")," ",s.schools," "):null)},Q=function(e){function t(e){var n,a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).nextPic=function(){a.isToShowPhotos&&(a.state.photos.length<2||(a.ind<a.state.photos.length-1?a.ind++:a.ind=0,a.setState({imgSrc:a.state.photos[a.ind].url})))};var o=a.props,l=o.photos,r=o.name;a.personName=r,a.isToShowPhotos=E.isToShowPhotos,a.ind=0;var s=a.isToShowPhotos?null===l||void 0===l?void 0:null===(n=l[a.ind])||void 0===n?void 0:n.url:null;return a.state={photos:l,imgSrc:s},a}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.state.imgSrc?this.isToShowPhotos?o.a.createElement("div",{className:"container-fluid px-0"},o.a.createElement("img",{onClick:this.nextPic,src:this.state.imgSrc,alt:"some image",className:"img-fluid w-100"})):o.a.createElement("div",null,o.a.createElement("label",{className:"text-center"},this.personName," ")):o.a.createElement("div",null)}}]),t}(o.a.Component),Y=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){n.parentObject.setState({distanceFilter:e.target.value})},n.state={radius:e.initialRadius||0},n.parentObject=e.parentObject,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=E.getInputStyleClasses(),t=[],n=1;n<100;n++)t.push(o.a.createElement("option",{key:n,value:n},n));return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Distance filter (mi):"),o.a.createElement("select",{className:e,value:this.state.radius,onChange:this.changeHandler},t)))}}]),t}(o.a.Component),ee=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){console.log(e.target.value);var t=parseInt(e.target.value);n.parentObject.changeState({ageFilterMin:t})},n.state={ageFilterMin:e.ageFilterMin||18},n.parentObject=e.parentObject,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=E.getInputStyleClasses(),t=[],n=18;n<50;n++)t.push(o.a.createElement("option",{key:n,value:n},n));return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Min age:"),o.a.createElement("select",{className:e,value:this.state.ageFilterMin,onChange:this.changeHandler},t)))}}]),t}(o.a.Component),te=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){console.log(e.target.value);var t=parseInt(e.target.value);n.parentObject.changeState({ageFilterMax:t})},n.state={ageFilterMax:e.ageFilterMax||1e3},n.parentObject=e.parentObject,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){for(var e=E.getInputStyleClasses(),t=[],n=18;n<55;n++)t.push(o.a.createElement("option",{key:n,value:n},n));return t.push(o.a.createElement("option",{key:1e3,value:1e3},"55+")),o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Maximal age:"),o.a.createElement("select",{className:e,value:this.state.ageFilterMax,onChange:this.changeHandler},t)))}}]),t}(o.a.Component),ne=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){n.setState({interval:e.target.value}),E.updatePollInterval=e.target.value,n.props.onSelectPollInterval(e.target.value)},n.state={interval:E.updatePollInterval},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Poll interval for getting updates to be every:"),o.a.createElement("select",{className:this.props.styles,value:this.state.interval,onChange:this.changeHandler},o.a.createElement("option",{value:"10000"},"10 sec"),o.a.createElement("option",{value:"20000"},"20 sec"),o.a.createElement("option",{value:"40000"},"40 sec"),o.a.createElement("option",{value:"50000"},"50 sec"),o.a.createElement("option",{value:"60000"},"1 min"),o.a.createElement("option",{value:"300000"},"5 min"),o.a.createElement("option",{value:"600000"},"10 min"))))}}]),t}(a.Component),ae=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){var t=e.target.value;E.applyClass(document.body,E.textColors,t),E.persistSetting("textColor",t),n.setState({selected:t}),n.props.triggerRender()},n.state={selected:E.getSetting("textColor")||E.textColors[0]},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Select text color:"),o.a.createElement("select",{className:this.props.styles,value:this.state.selected,onChange:this.changeHandler},E.textColors.map((function(e){return o.a.createElement("option",{key:e.name,value:e.class},e.name)})))))}}]),t}(a.Component),oe=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){var t=e.target.value;E.applyClass(document.body,E.bgColors,t),E.persistSetting("bgColor",t),n.setState({selected:t}),n.props.triggerRender()},n.state={selected:E.getSetting("bgColor")||E.bgColors[0]},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Select background color:"),o.a.createElement("select",{className:this.props.styles,value:this.state.selected,onChange:this.changeHandler},E.bgColors.map((function(e){return o.a.createElement("option",{key:e.name,value:e.class},e.name)})))))}}]),t}(a.Component),le=function(e){function t(e){var n,a,o,l;return Object(i.a)(this,t),(l=Object(u.a)(this,Object(d.a)(t).call(this,e))).saveProfile=function(){var e={age_filter_max:l.state.ageFilterMax,age_filter_min:l.state.ageFilterMin,distance_filter:l.state.distanceFilter,discoverable:l.state.discoverable};p.doPost(v.URLS.PROFILE,e,{})},l.disableSaveButton=function(){l.state.ageFilterMax<l.state.ageFilterMin?l.setState({isButtonDisabled:!0}):l.setState({isButtonDisabled:!1})},l.getProfile=function(){l.isLoading=!0,p.doGet(v.URLS.PROFILE,{}).then((function(e){(null===e||void 0===e?void 0:e.data)&&(N.addToStore("profile",e),l.setState({distanceFilter:e.data.distance_filter,ageFilterMax:e.data.age_filter_max,ageFilterMin:e.data.age_filter_min,discoverable:e.data.discoverable,profile:e.data},(function(){l.isLoading=!1})))})).catch((function(e){console.error(e),l.isLoading=!1}))},l.changeState=function(e){l.setState(e,(function(){l.disableSaveButton()}))},l.toggleShowProfile=function(e){var t;l.setState({discoverable:null===e||void 0===e?void 0:null===(t=e.target)||void 0===t?void 0:t.checked})},l.onSelectPollInterval=function(e){w.startUpdatePoll(e),l.setState({pollInterval:e})},l.triggerRender=function(){l.setState({styles:E.getInputStyleClasses()})},l.toggleShowPicsCheckbox=function(e){E.isToShowPhotos=e.target.checked,l.setState({isToShowPhotos:E.isToShowPhotos})},l.state={styles:E.getInputStyleClasses(),isToShowPhotos:E.isToShowPhotos,profile:null===(n=l.props)||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:null===(o=a.profile)||void 0===o?void 0:o.data,hits:[],error:null,distanceFilter:null,ageFilterMax:null,ageFilterMin:null,discoverable:!1,isButtonDisabled:!1},l.isLoading=!1,l}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.isLoading||this.getProfile()}},{key:"render",value:function(){var e,t,n,a=this,l=null===(e=this.state)||void 0===e?void 0:e.profile;if(!l)return o.a.createElement("div",null);var r=(null===l||void 0===l?void 0:l.pos)?[null===l||void 0===l?void 0:null===(t=l.pos)||void 0===t?void 0:t.lat,null===l||void 0===l?void 0:null===(n=l.pos)||void 0===n?void 0:n.lon]:[0,0],s=[{image:o.a.createElement(Q,{photos:l.photos,name:l.name}),info:o.a.createElement((function(){return o.a.createElement("div",null,o.a.createElement($,{person:l}),o.a.createElement("br",null),o.a.createElement(Y,{initialRadius:a.state.distanceFilter,parentObject:a}),o.a.createElement(ee,{ageFilterMin:a.state.ageFilterMin,parentObject:a}),o.a.createElement(te,{ageFilterMax:a.state.ageFilterMax,parentObject:a}),o.a.createElement(Z,{label:"public profile",condition:a.state.discoverable,changeHandler:a.toggleShowProfile}),o.a.createElement("br",null),o.a.createElement("button",{type:"button",className:"btn btn-primary",disabled:a.state.isButtonDisabled,onClick:a.saveProfile}," Save "),o.a.createElement("br",null),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("p",null),o.a.createElement("p",null),o.a.createElement(ne,{styles:a.state.styles,onSelectPollInterval:a.onSelectPollInterval}),o.a.createElement(oe,{styles:a.state.styles,triggerRender:a.triggerRender}),o.a.createElement(ae,{styles:a.state.styles,triggerRender:a.triggerRender}),o.a.createElement(Z,{label:"show photos",condition:a.state.isToShowPhotos,changeHandler:a.toggleShowPicsCheckbox})))}),null)}],i=[r],c={banner:!1,control:{values:i,onClick:function(e){i=[e],c.control.values=[e],function(e){var t={lat:e[0],lon:e[1]};p.doPost(v.URLS.SEND_LOCATION,t,{})}(e)}}},u={bindMap:!0,startPort:"default",overlayAll:!0,showControls:!1,showInputs:!1,useDynamic:!0,pointMode:c,precision:6};return o.a.createElement("div",null,o.a.createElement(X.a,{data:s,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:1,showPagination:!1}),o.a.createElement("br",null),o.a.createElement(J.a,u),o.a.createElement("br",null),o.a.createElement("span",{className:"float-right"}," ver: ",v.VERSION),o.a.createElement("br",null),o.a.createElement("p",null))}}]),t}(o.a.Component),re=Object(F.f)(le),se=n(38),ie=new(function(e){function t(){var e,n;Object(i.a)(this,t);for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(o)))).getUserData=function(e,t){var n;console.log(e);var a=null===e||void 0===e?void 0:null===(n=e.person)||void 0===n?void 0:n._id,o=e.person||{};p.doGet(v.URLS.USER+a,{}).then((function(n){var a,l,r,s=null===n||void 0===n?void 0:null===(a=n.data)||void 0===a?void 0:a.results;e.user=s,o.distance_mi=null===s||void 0===s?void 0:s.distance_mi,o.name=(null===s||void 0===s?void 0:s.name)||(null===o||void 0===o?void 0:o.name),o.birth_date=(null===s||void 0===s?void 0:s.birth_date)||(null===o||void 0===o?void 0:o.birth_date),o.bio=(null===s||void 0===s?void 0:s.bio)||(null===o||void 0===o?void 0:o.bio),o.jobs=(null===s||void 0===s?void 0:s.jobs)||o.jobs,o.schools=(null===s||void 0===s?void 0:s.schools)||o.schools;var i={city:{name:null===s||void 0===s?void 0:null===(l=s.city)||void 0===l?void 0:l.name},country:{name:null===s||void 0===s?void 0:null===(r=s.city)||void 0===r?void 0:r.region}};o.pos_info=(null===o||void 0===o?void 0:o.pos_info)||i,t(e)})).catch((function(n){console.error(n),o.error=n,t(e)}))},n}return Object(m.a)(t,e),t}(o.a.Component)),ce=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).doClick=function(e){n.changeHandler(e,n.match)},n.state={imgSrc:e.src},n.condition=e.condition,n.changeHandler=e.changeHandler,n.match=e.match,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.condition?o.a.createElement("div",{className:"container-fluid px-0"},o.a.createElement("img",{onClick:this.doClick,src:this.state.imgSrc,alt:"new",className:"img-fluid w-100"})):o.a.createElement("div",{onClick:this.doClick},o.a.createElement("label",{className:"text-center"},this.match.person.name))}}]),t}(o.a.Component),ue=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).sortByLastActivityDate=function(e,t){var n=new Date(e.last_activity_date).getTime();return new Date(t.last_activity_date).getTime()-n},n.applySorting=function(e,t){try{e.sort(t)}catch(n){console.error(n)}return e},n.getUserData=function(e,t){ie.getUserData(t,(function(e){n.props.history.push({pathname:"/friend",state:{args:e}})}))},n.state={showUser:!1,isVisible:!1,msgMatches:[],sortingFunc:n.sortByLastActivityDate},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=N.getStore().update.data.matches;this.applySorting(t,this.state.sortingFunc);var n=t.map((function(t){var n,a=t.person;if(a){var l={condition:E.isToShowPhotos,src:a.photos[0].url,match:t,changeHandler:e.getUserData};n={firstName:a.name,lastName:a.birth_date,image:o.a.createElement(ce,l)}}return Object(se.a)({},n)}));return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement(X.a,{className:"-striped -highlight",data:n,columns:[{columns:[{Header:"Image",accessor:"image"},{Header:"First Name",accessor:"firstName"}]}],defaultPageSize:n.length,pageSize:n.length,sortable:!1,showPagination:!1}),o.a.createElement("br",null)))}}]),t}(o.a.Component),de=Object(F.f)(ue);var me=function(e){return o.a.createElement("div",null,o.a.createElement(T.b,{to:{pathname:e.pathname,state:{data:e.data}}},o.a.createElement("button",{type:"button",className:"btn btn-primary"},e.label)))},he=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).remove=function(e){M.removeBookmark(e)},n.save=function(e){M.saveBookmark(e)},n.deleteMatch=function(e){p.doDelete(v.URLS.MATCH+e,{})},n.isBookmarked=function(e){return void 0!==n.allBookmarks[e]&&null!==n.allBookmarks[e]},n.allBookmarks=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.location.state.args;console.log(t),this.allBookmarks=b.getBookmarksAsObject();var n=[{image:o.a.createElement(Q,{photos:t.person.photos,name:t.person.name}),info:o.a.createElement((function(){return o.a.createElement("div",null,o.a.createElement(me,{label:" \u270d\ufe0f ",data:t,pathname:"/chat"}),o.a.createElement("div",{className:"mt-1"},e.isBookmarked(t.person._id)?null:o.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return e.save(t.person._id)}}," ",o.a.createElement("span",null,"\u2606")," "),e.isBookmarked(t.person._id)?o.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){return e.remove(t.person._id)}}," ",o.a.createElement("span",null,"\u2606")):null,o.a.createElement("button",{type:"button",className:"btn btn-danger ml-2 float-right",onClick:function(){return e.deleteMatch(t.id)}}," \u2716\ufe0f ")),o.a.createElement($,{person:t.person}))}),null)}];return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement(X.a,{data:n,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:1,showPagination:!1}),o.a.createElement("br",null)))}}]),t}(o.a.Component),ve=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).getBookmarksAsObject=function(){n.allBookmarks=b.getBookmarksAsObject()},n.getNewFriends=function(e){p.doGet(v.URLS.NEW_FRIENDS,{}).then((function(t){var a,o=null===t||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.results;n.isMountedOk&&(e(),n.setState({allFr:o}))})).catch((function(e){console.log(e)}))},n.pass=function(e){p.doGet(v.URLS.PASS+e,{}).then((function(e){})).catch((function(e){console.log(e)}))},n.like=function(e){p.doGet(v.URLS.LIKE+e,{}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},n.isBookmarked=function(e){return void 0!==n.allBookmarks[e]&&null!==n.allBookmarks[e]},n.state={beanId:e.beanId,allFr:[]},n.isMountedOk=!0,n.allBookmarks=null,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){k.add(this),this.getNewFriends(this.getBookmarksAsObject),this.isMountedOk=!0;var e=k.get("header1");e&&e.showMoreFriendsRefreshButton()}},{key:"componentWillUnmount",value:function(){k.remove(this),this.isMountedOk=!1;var e=k.get("header1");e&&e.hideMoreFriendsRefreshButton()}},{key:"render",value:function(){var e=this,t=function(t){var n=t.person,a=e.isBookmarked(null===n||void 0===n?void 0:n._id);return o.a.createElement("div",{className:"text-justify text-wrap"},o.a.createElement("div",null,o.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return e.like(n._id)}}," \ud83d\udc4d "),o.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){return e.pass(n._id)}}," \ud83d\udc4e "),a?null:o.a.createElement("button",{type:"button",className:"btn btn-primary float-right ml-1",onClick:function(){return M.saveBookmark(null===n||void 0===n?void 0:n._id)}}," \ud83d\udcd1 "),a?o.a.createElement("button",{type:"button",className:"btn btn-danger float-right ml-1",onClick:function(){return M.removeBookmark(null===n||void 0===n?void 0:n._id)}}," \ud83d\udcd1 "):null),o.a.createElement($,{person:n}))},n=function(e){return o.a.createElement(Q,{photos:e.photos,name:e.name})},a=this.state.allFr.map((function(e){var a={info:o.a.createElement(t,{person:e}),image:o.a.createElement(n,{photos:e.photos,name:e.name})};return Object(se.a)({},a)}));return o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement(X.a,{className:"-striped -highlight",data:a,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:a.length,pageSize:a.length,showPagination:!1}),o.a.createElement("br",null)))}}]),t}(o.a.Component),ge=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).getFriendRequests=function(){p.doGet(v.URLS.FAST_MATCH,{}).then((function(e){var t,a;n.isMountedOk&&(null===e||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.results)&&n.setState({allFr:e.data.data.results})})).catch((function(e){console.log(e)}))},n.state={allFr:[],hits:[],isLoading:!1,error:null},n.isMountedOk=!0,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.isMountedOk=!0,this.getFriendRequests()}},{key:"componentWillUnmount",value:function(){this.isMountedOk=!1}},{key:"render",value:function(){var e=function(e){return o.a.createElement("div",{className:"text-justify text-wrap"}," ",e.info," ")},t=function(e){return o.a.createElement(Q,{photos:e.photos})},n=this.state.allFr.map((function(n){var a,l=(null===n||void 0===n?void 0:null===(a=n.user)||void 0===a?void 0:a.recently_active)?"\ud83d\udd50":"";console.log(l);var r={info:o.a.createElement(e,{info:l}),image:o.a.createElement(t,{photos:n.user.photos})};return Object(se.a)({},r)}));return o.a.createElement("div",null,o.a.createElement("div",{className:"text-center p-1 "}),o.a.createElement("div",null,o.a.createElement(X.a,{className:"-striped -highlight",data:n,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Recently Active",accessor:"info"}]}],sortable:!1,defaultPageSize:n.length,pageSize:n.length,showPagination:!1,style:{width:"100%",height:"30%"}}),o.a.createElement("br",null)))}}]),t}(o.a.Component),fe=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).onSelectPollInterval=function(e){w.startUpdatePoll(e),n.setState({pollInterval:e})},n.triggerRender=function(){n.setState({styles:E.getInputStyleClasses()})},n.toggleShowPicsCheckbox=function(e){E.isToShowPhotos=e.target.checked,n.setState({isToShowPhotos:E.isToShowPhotos})},n.state={styles:E.getInputStyleClasses(),isToShowPhotos:E.isToShowPhotos},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("span",{className:"float-right"}," ver: ",v.VERSION),o.a.createElement("p",null),o.a.createElement(ne,{styles:this.state.styles,onSelectPollInterval:this.onSelectPollInterval}),o.a.createElement(oe,{styles:this.state.styles,triggerRender:this.triggerRender}),o.a.createElement(ae,{styles:this.state.styles,triggerRender:this.triggerRender}),o.a.createElement(Z,{label:"show photos",condition:this.state.isToShowPhotos,changeHandler:this.toggleShowPicsCheckbox}))}}]),t}(o.a.Component),pe=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeState=function(e){n.setState(e)},n.addMsgMatch=function(e){if(!(n.findInMsgMatches(e)>-1)){var t=n.state.msgMatches;n.state.msgMatches.push(e),n.setState({msgMatches:t}),n.toggleFlashTabTitle()}},n.findInMsgMatches=function(e){for(var t=n.state.msgMatches,a=0,o=t.length;a<o;a++)if(t[a].id===e.id)return a;return-1},n.removeMsgMatch=function(e){var t=n.findInMsgMatches(e);if(t>-1){var a=n.state.msgMatches;a.splice(t,1),n.setState({msgMatches:a},(function(){return n.toggleFlashTabTitle()}))}},n.showMoreFriendsRefreshButton=function(){n.setState({isVisibleMoreFriendsTab:!0})},n.hideMoreFriendsRefreshButton=function(){n.setState({isVisibleMoreFriendsTab:!1})},n.changeButtonVisibility=function(e){n.setState(e)},n.toggleFlashTabTitle=function(){n.state.msgMatches.length>0&&!n.flashIntervalObj?n.startFlashTabTitle():0===n.state.msgMatches.length&&n.stopFlashTabTitle()},n.startFlashTabTitle=function(){n.flashIntervalObj=setInterval((function(){n.initialTitle===document.title?document.title="("+n.state.msgMatches.length+") "+n.initialTitle:document.title=n.initialTitle}),800)},n.stopFlashTabTitle=function(){clearTimeout(n.flashIntervalObj),n.flashIntervalObj=null,document.title=n.initialTitle},n.getUserData=function(e){ie.getUserData(e,(function(e){n.props.history.push({pathname:"/friend",state:{args:e}})}))},n.goChat=function(e){n.props.history.push({pathname:"/chat",state:{data:e}})},n.getNewFriends=function(){var e=k.get("moreFriends1");n.state.isVisible&&(null===e||void 0===e?void 0:e.isMountedOk)&&e.getNewFriends(e.getBookmarksAsObject)},n.state={beanId:e.beanId,showUser:!1,isVisible:!1,isVisibleMoreFriendsTab:!1,msgMatches:[]},n.initialTitle=document.title,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){k.add(this)}},{key:"componentWillUnmount",value:function(){k.remove(this)}},{key:"render",value:function(){var e,t=this,n=function(e){return o.a.createElement("div",null,o.a.createElement(T.c,{exact:!0,activeClassName:"active",to:e.to},o.a.createElement("button",{type:"button",className:"btn btn-primary"},e.label)))},a=!!this.state.msgMatches.length,l=null===N||void 0===N?void 0:null===(e=N.profile)||void 0===e?void 0:e.data;return o.a.createElement("nav",null,o.a.createElement("div",{className:"text-center"},this.state.isVisible?o.a.createElement("span",{className:"float-left"}," ",b.getPhone()," "):null,o.a.createElement("div",{className:"btn-group"},null,this.state.isVisible?o.a.createElement(n,{to:"/user",label:"\ud83d\udc66"}):null,this.state.isVisible?o.a.createElement(n,{to:"/pals",label:"\ud83e\udd1d"}):null,this.state.isVisible?this.state.isVisibleMoreFriendsTab?o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return t.getNewFriends()}}," \ud83c\udf0d "):o.a.createElement(n,{to:"/more-pals",label:" \ud83c\udf0d "}):null,this.state.isVisible?o.a.createElement(n,{to:"/pal-requests",label:"\ud83d\udc4b"}):null,this.state.isVisible?o.a.createElement(n,{to:"/notes",label:"\ud83d\udcd1"}):null,!this.state.isVisible&&l?o.a.createElement(n,{to:"/settings",label:"\ud83d\udee0\ufe0f"}):null,null,this.state.isVisible&&a?o.a.createElement((function(e){var n=e.data;return n.messages&&0!==n.messages.length?o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){return t.goChat(n)},className:"btn btn-primary"},"\ud83d\udc8c ",t.state.msgMatches.length," ")):o.a.createElement("div",null,o.a.createElement("button",{onClick:function(){t.removeMsgMatch(n),t.getUserData(n)},className:"btn btn-primary"},"\ud83d\udc8c ",t.state.msgMatches.length," "))}),{data:this.state.msgMatches[0]}):null)))}}]),t}(o.a.Component),be=Object(F.f)(pe),Ee=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).createMessage=function(e,t){var a=new Date;return{created_date:a.toISOString(),from:t.profile.data._id,match_id:e.id,message:n.state.value,sent_date:a.toISOString(),timestamp:a.getTime(),to:e.person._id}},n.onKeyPress=function(e){var t,a;if("Enter"===e.key){for(var o=(null===N||void 0===N?void 0:null===(t=N.update)||void 0===t?void 0:null===(a=t.data)||void 0===a?void 0:a.matches)||[],l=0;l<o.length;l++){var r=o[l];if(r.person._id===n.state.friendId){var s=n.createMessage(r,n.state.store);n.injectEmoji(s),p.doPost(v.URLS.SEND_MESSAGE,s,{}),o[l].messages.push(s),n.state.triggerRenderFunc();break}}n.setState({value:""})}},n.onChange=function(e){var t=e.srcElement||e.target;n.setState({value:t.value})},n.state={value:"",store:e.data,friendId:e.friendId,triggerRenderFunc:e.triggerRenderFunc},n.getStyles=E.getInputStyleClasses;return n.injectEmoji=e.emojiInjectorFunc||function(e){return e},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e={placeholder:"Write...",value:this.state.value,onChange:this.onChange,className:this.getStyles(),onKeyPress:this.onKeyPress};return o.a.createElement("div",null,o.a.createElement("input",Object.assign({},e,{type:"text"})))}}]),t}(o.a.Component),ke=function(e){function t(e){var n;Object(i.a)(this,t);var a=(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).props.msg,o=new Date(a.timestamp),l=o.toLocaleTimeString(),r=o.toLocaleDateString();return r!==(new Date).toLocaleDateString()&&(l=l+",  "+r),n.state={isSeen:a.isSeen,showDate:!1,date:l},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.msg;return o.a.createElement("div",{onClick:function(){e.setState({showDate:!0}),setTimeout((function(){e.setState({showDate:!1})}),5e3)}},o.a.createElement("p",{className:"text-justify text-wrap"},"  ",t.message," "),this.state.isSeen?o.a.createElement("span",{className:"badge badge-secondary text-justify text-wrap"},"seen"):null,this.state.showDate?o.a.createElement("span",{className:"badge small"},"  ",this.state.date," "):null)}}]),t}(o.a.Component),Oe=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).changeHandler=function(e){var t=k.get("chat1");n.setState({numberMsgShown:e.target.value}),t&&t.changeState({numberMsgShown:parseInt(e.target.value)})},n.state={numberMsgShown:10,getStyles:e.getStyles},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return o.a.createElement("form",null,o.a.createElement("div",{className:"form-group"},o.a.createElement("label",null,"Number of messages to show:"),o.a.createElement("select",{className:this.state.getStyles(),value:this.state.numberMsgShown,onChange:this.changeHandler},o.a.createElement("option",{value:"10"},"10"),o.a.createElement("option",{value:"20"},"20"),o.a.createElement("option",{value:"50"},"50"),o.a.createElement("option",{value:"70"},"70"))))}}]),t}(a.Component),Se=[{text:":)",face:"\ud83d\ude03"},{text:";)",face:"\ud83d\ude09"},{text:":(",face:"\ud83d\ude1e"},{text:":*",face:"\ud83d\ude18"},{text:":P",face:"\ud83d\ude1b"},{text:":p",face:"\ud83d\ude1b"},{text:":\u041f",face:"\ud83d\ude1b"},{text:":\u043f",face:"\ud83d\ude1b"},{text:":D",face:"\ud83d\ude00"},{text:":\u0414",face:"\ud83d\ude00"},{text:":\u0434",face:"\ud83d\ude00"}],ye=function(e){if(!(null===e||void 0===e?void 0:e.message))return e;for(var t=0;t<Se.length;t++)for(var n=Se[t],a=e.message.indexOf(n.text);a>-1;)e.message=e.message.replace(n.text,n.face),a=e.message.indexOf(n.text);return e},je=function(e){function t(e){var n;Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).onFocus=function(e){n.isOnFocus=!0,n.deleteFromHeader()},n.onBlur=function(e){n.isOnFocus=!1},n.prepareMessages=function(e,t,n){var a=[];a.length=n;for(var l=e.length-1;0<=n;n--,l--){var r=e[l];r||(r={});var s={};a[n]=s,r.from===t?s.theirs=o.a.createElement(ke,{msg:r}):s.mine=o.a.createElement(ke,{msg:r})}return a},n.triggerRenderFunc=function(){var e=N.getMatchById(n.state.match._id),t=e.seen?e.seen.last_seen_msg_id:null;n.isMountedOk&&n.setState({lastSeenMsg:t,match:e,messages:e.messages})},n.changeState=function(e){n.setState(e)},n.sendSeen=function(e){if(n.state.lastSeenMsg||console.log("empty value of 'lastSeenMsg'.."),e&&(null===e||void 0===e?void 0:e.length))for(var t=e.length-1;0<=t;t--){var a=e[t];if(a&&a.theirs){var o=a.theirs.props.msg;if(o._id!==n.state.lastSeenMsg){p.doGet(v.URLS.SEND_SEEN+o.match_id+"/"+o._id,{});var l=n.state.match;return l.seen&&(l.seen.last_seen_msg_id=o._id),void n.deleteFromHeader()}if(a.theirs)break}}else n.deleteFromHeader()},n.deleteFromHeader=function(){var e=k.get("header1");e&&n.isOnFocus&&e.removeMsgMatch(n.state.match)};var a=e.location.state.data,l=a.person._id,r=a.seen?a.seen.last_seen_msg_id:null;return n.state={lastSeenMsg:r,numberMsgShown:10,matchId:a.id,store:N,match:a,friendId:l,messages:a.messages},n.inputStyles=E.getInputStyleClasses,n.isOnFocus=!0,n.isMountedOk=!0,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){k.add(this),window.addEventListener("focus",this.onFocus),window.addEventListener("blur",this.onBlur),this.isMountedOk=!0}},{key:"componentWillUnmount",value:function(){k.remove(this),window.removeEventListener("focus",this.onFocus),window.removeEventListener("blur",this.onBlur),this.isMountedOk=!1}},{key:"render",value:function(){var e=[{columns:[{Header:this.state.match.person.name,accessor:"theirs"},{Header:"Me",accessor:"mine"}]}],t=this.prepareMessages(this.state.messages,this.state.friendId,this.state.numberMsgShown);this.sendSeen(t);var n={data:this.state.store,friendId:this.state.match.person._id,triggerRenderFunc:this.triggerRenderFunc,emojiInjectorFunc:ye};return this.isMountedOk?o.a.createElement("div",null,o.a.createElement(Oe,{getStyles:this.inputStyles}),o.a.createElement("div",null,o.a.createElement(X.a,{data:t,columns:e,defaultPageSize:t.length,pageSize:t.length,showPagination:!1,bordered:!1,sortable:!1}),o.a.createElement("div",null,o.a.createElement(Ee,n)),o.a.createElement("br",null))):o.a.createElement("div",null)}}]),t}(o.a.Component),_e=Object(F.f)(je),Ce=function(e){function t(e){var n;return Object(i.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).saveAllByPhone=function(){M.saveAllByPhone()},n.getOne=function(){M.getOne()},n.getBookmarks=function(){M.getBookmarks()},n.removeBookmark=function(e){M.removeBookmark(e),this.index--},n.pass=function(e){p.doGet(v.URLS.PASS+e,{}).then((function(e){})).catch((function(e){console.log(e)}))},n.like=function(e){p.doGet(v.URLS.LIKE+e,{}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},n.processUserData=function(e){var t;if(null===e||void 0===e?void 0:null===(t=e.person)||void 0===t?void 0:t.error)try{var a,o;console.log("User id: "+(null===e||void 0===e?void 0:null===(a=e.person)||void 0===a?void 0:a._id)+" will be removed from Bookmarks list"),M.removeBookmark(null===e||void 0===e?void 0:null===(o=e.person)||void 0===o?void 0:o._id),n.match=null}catch(l){console.error(l)}n.match=e,n.setState({match:e})},n.get=function(e){var t=b.getBookmarks();n.index=n.index+e,n.index<0?n.index=t.length-1:n.index>t.length-1&&(n.index=0);var a=t[n.index];if(a){var o=n.formDummyMatch(a);ie.getUserData(o,n.processUserData)}else console.error("'id' is "+a)},n.isBookmarked=function(e){return void 0!==n.allBookmarks[e]&&null!==n.allBookmarks[e]},n.state={match:null},n.index=0,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillMount",value:function(){this.allBookmarks=b.getBookmarksAsObject();var e=b.getBookmarks()[this.index];if(e){var t=this.formDummyMatch(e);ie.getUserData(t,this.processUserData)}}},{key:"formDummyMatch",value:function(e){return{person:{_id:e}}}},{key:"render",value:function(){var e,t,n,a=this;if(!this.match)return o.a.createElement("div",null,o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a.get(-1)}}," \u2b05\ufe0f "),o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a.get(1)}}," \u27a1\ufe0f "));var l=this.match,r=[{image:o.a.createElement((function(e){return o.a.createElement(Q,{photos:e.photos,name:e.name})}),{photos:null===l||void 0===l?void 0:null===(e=l.user)||void 0===e?void 0:e.photos,name:null===l||void 0===l?void 0:null===(t=l.user)||void 0===t?void 0:t.name}),info:o.a.createElement((function(){var e,t=null===l||void 0===l?void 0:null===(e=l.person)||void 0===e?void 0:e._id,n=a.isBookmarked(t);return o.a.createElement("div",null,o.a.createElement("div",{className:"text-justify text-wrap"},o.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return a.like(t)}}," \ud83d\udc4d "),o.a.createElement("button",{type:"button",className:"btn btn-danger",onClick:function(){return a.pass(t)}}," \ud83d\udc4e "),n?null:o.a.createElement("button",{type:"button",className:"btn btn-primary float-right ml-1",onClick:function(){return M.saveBookmark(t)}}," \ud83d\udcd1 "),n?o.a.createElement("button",{type:"button",className:"btn btn-danger float-right ml-1",onClick:function(){return M.removeBookmark(t)}}," \ud83d\udcd1 "):null),o.a.createElement($,{person:null===l||void 0===l?void 0:l.person}))}),null)}];return o.a.createElement("div",null,o.a.createElement("div",{className:"text-justify text-wrap text-center float-center"},o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a.get(-1)}}," \u2b05\ufe0f "),o.a.createElement("button",{type:"button",disabled:!0,className:"btn btn-secondary"}," ",this.index+1," of ",null===(n=b.getBookmarks())||void 0===n?void 0:n.length," "),o.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return a.get(1)}}," \u27a1\ufe0f ")),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement(X.a,{data:r,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:1,showPagination:!1})))}}]),t}(o.a.Component),Ne=function(){return o.a.createElement("div",{className:"container",style:{paddingTop:10}},o.a.createElement(T.a,null,o.a.createElement(be,{beanId:"header1"}),o.a.createElement(F.c,null,o.a.createElement(F.a,{exact:!0,path:"/",component:P}),o.a.createElement(F.a,{path:"/user",render:function(){return o.a.createElement(re,{data:N})}}),o.a.createElement(F.a,{path:"/phone",component:L}),o.a.createElement(F.a,{path:"/phone-token",component:V}),o.a.createElement(F.a,{path:"/friend",component:he}),o.a.createElement(F.a,{path:"/chat",render:function(){return o.a.createElement(_e,{beanId:"chat1"})}}),o.a.createElement(F.a,{path:"/notes",render:function(){return o.a.createElement(Ce,{beanId:"notes1"})}}),o.a.createElement(F.a,{path:"/pals",render:function(){return o.a.createElement(de,{data:N.updates})}}),o.a.createElement(F.a,{path:"/more-pals",render:function(){return o.a.createElement(ve,{data:N.updates,beanId:"moreFriends1"})}}),o.a.createElement(F.a,{path:"/pal-requests",render:function(){return o.a.createElement(ge,{data:N.updates})}}),o.a.createElement(F.a,{path:"/settings",render:function(){return o.a.createElement(fe,{beanId:"appSettings1"})}}),o.a.createElement(F.a,{path:"/confirm-token",component:K}),o.a.createElement(F.a,{path:"*",component:P}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(266);r.a.render(o.a.createElement(Ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[123,1,2]]]);
//# sourceMappingURL=main.021539bf.chunk.js.map