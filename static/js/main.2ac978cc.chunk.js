(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{122:function(e,t,a){e.exports=a(264)},264:function(e,t,a){"use strict";a.r(t);var n,r,o=a(0),s=a.n(o),l=a(26),c=a.n(l),i=a(4),u=a(6),m=a(5),h=a(7),d="http://localhost:8484/",g={URLS:{BASE_URL:d,AUTH:{PHONE:d+"requestCode",GET_TOKEN:d+"getToken/"},UPDATES:d+"updates",PROFILE:d+"profile",USER:d+"user/",SEND_MESSAGE:d+"postMessage",SEND_LOCATION:d+"location",NEW_FRIENDS:d+"new-friends",SEND_SEEN:d+"seen/",FAST_MATCH:d+"fast-match",LIKE:d+"like/",PASS:d+"pass/"},LOCAL_CASH_VAR_NAME:"__TnDr__",AUTH_HEADER_NAME:"X-Auth-Token",PHONE_HEADER_NAME:"phone-number"};n=g.PHONE_HEADER_NAME,r=g.AUTH_HEADER_NAME;var p=new(function(e){function t(){var e,a;Object(i.a)(this,t);for(var o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s))))[n]=null,a[r]=null,a.lsobj=function(){var e,t=g.LOCAL_CASH_VAR_NAME,a=localStorage.getItem(t);if(!a)return a={},localStorage.setItem(t,JSON.stringify(a)),a;try{e=JSON.parse(a)}catch(n){console.log(n),localStorage.removeItem(t)}return e}(),a.getLocalStorage=function(){return a.lsobj},a.setLocalStorage=function(e){if("object"!==typeof e)throw new Error("'obj' must be of type 'object'! ");a.private_____persistLocalStorage(e),a.lsobj=e},a.parseLocalStorage=function(){var e=localStorage.getItem(g.LOCAL_CASH_VAR_NAME);return JSON.parse(e)},a.private_____persistLocalStorage=function(e){localStorage.setItem(g.LOCAL_CASH_VAR_NAME,JSON.stringify(e))},a}return Object(h.a)(t,e),t}(s.a.Component)),f=new(function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).applySettingsFromLocalStorage=function(){if(p.getLocalStorage()[p[g.PHONE_HEADER_NAME]]){var e=a.getSetting("textColor")||a.textColors[0];a.applyClass(document.body,a.textColors,e);var t=a.getSetting("bgColor")||a.bgColors[0];a.applyClass(document.body,a.bgColors,t)}},a.persistSetting=function(e,t){var a=p.getLocalStorage(),n=p[g.PHONE_HEADER_NAME];if(n&&a[n]){var r=a[n].settings;r||(r={}),r[e]=t,a[n].settings=r,p.setLocalStorage(a)}},a.getSetting=function(e){var t=p.getLocalStorage(),a=p[g.PHONE_HEADER_NAME];if(a&&t[a]){var n=t[a].settings;if(n)return n[e]}},a.applyClass=function(e,t,a){t.forEach((function(t){e.classList.remove(t.class)})),e.classList.add(a)},a.getInputStyleClasses=function(){return"form-control "+(a.getSetting("textColor")||" ")+" "+(a.getSetting("bgColor")||"")},a.textColors=[{name:"Gray",class:"text-muted"},{name:"White",class:"text-white"},{name:"Dark",class:"text-dark"},{name:"Black",class:"text-body"}],a.bgColors=[{name:"Gray",class:"bg-secondary"},{name:"Dark",class:"bg-dark"},{name:"Light",class:"bg-light"}],a.updatePollInterval=2e4,a.isToShowPhotos=!0,a}return Object(h.a)(t,e),t}(s.a.Component)),b=a(116),E=a.n(b),v=new(function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).execute=function(e,t,a,n){return E()({method:e,url:t,data:a,headers:n})},a.doPost=function(e,t,n){return a.execute("post",e,t,a.getHeaders(n))},a.doGet=function(e,t){return a.execute("get",e,{},a.getHeaders(t))},a.getHeaders=function(e){var t=g.AUTH_HEADER_NAME,a=g.PHONE_HEADER_NAME;return e||(e={}),p[a]&&(e[a]=p[a]),p[t]&&(e[t]=p[t]),e},a}return Object(h.a)(t,e),t}(s.a.Component)),S=new(function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).add=function(e){if(!e||!e.state)throw new Error("Not allowed 'null' values for 'bean': "+e+" !");var t=e.state.beanId||e.props.beanId;if(!t)throw new Error("Not allowed 'null' value for 'beanId' "+t+" !");a.context[t]&&console.warn("Bean with 'beanId': "+t+"is already registered under BeanContextAware!"),a.context[t]=e},a.get=function(e){if(!e)throw new Error("Not allowed 'null' value for 'beanId' "+e+" !");return a.context[e]},a.remove=function(e){if(!e)throw new Error("Not allowed 'null' value for 'bean' "+e+" !");if("string"!==typeof e){var t=e.state.beanId||e.props.beanId;delete a.context[t]}else delete a.context[e]},a.context={},a}return Object(h.a)(t,e),t}(s.a.Component)),O=a(12),y=a(267),_=Object(O.b)({form:y.a}),j=(window.devToolsExtension?window.devToolsExtension()(O.c):O.c)(_),N=[],C=function(e){for(N.push(e);N.length>0;){N.shift()()}};j.getStore=function(){return C((function(){})),j},j.getMatchById=function(e){if(!e)throw new Error("'id' is not allowed to be: "+e);for(var t=j.getStore().update.data.matches,a=0;a<t.length;a++)if(e===t[a]._id)return t[a];return null},j.addToStore=function(e,t){if(!e||"string"!=typeof e)throw new Error("Only objects of type 'string' are allowed!");C((function(){j[e]=t}))};var w=j,A=new(function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).checkIfLogged=function(e,t,n){v.doGet(g.URLS.PROFILE,e).then((function(e){w.addToStore("profile",e),t(),a.getUpdates(a.getLastActivityDate()),a.startUpdatePoll(f.updatePollInterval)})).catch((function(e){console.error(e),n()}))},a.mergeUpdates=function(e,t){for(var n=t.data.matches,r=0;r<n.length;r++){var o=n[r],s=e.getMatchById(o._id);if(!s){e.getStore().update.data.matches.push(o),a.addToUnreadMessagesBadge(o);break}for(var l=o.messages,c=l.length,i=s.messages.length-1;0<=c||0<=i;i--,c--)s.messages[i]&&!s.messages[i]._id&&s.messages.splice(i,1);s.messages=s.messages.concat(l);var u=o.seen?o.seen.last_seen_msg_id:null;u&&(s.seen||(s.seen={}),s.seen.last_seen_msg_id=u);var m=o.last_activity_date?o.last_activity_date:null;m&&(s.last_activity_date=m)}},a.markLastUneadMessages=function(e,t){for(var n=t.data.matches,r=0;r<n.length;r++){var o=n[r],s=e.getMatchById(o._id),l=o.seen?o.seen.last_seen_msg_id:null,c=s.seen?s.seen.last_seen_msg_id:null,i=e.profile.data;if((l=l||c)&&i&&i._id)for(var u=o.messages,m=u.length-1;0<=m;m--){var h=u[m];if(h.from&&i._id!==h.from){h._id!==l&&a.addToUnreadMessagesBadge(s);break}}}},a.addToUnreadMessagesBadge=function(e){var t=S.get("header1");t&&t.addMsgMatch(e)},a.getUpdates=function(e){var t=S.get("header1"),n=S.get("chat1"),r={last_activity_date:e};v.doPost(g.URLS.UPDATES,r,{}).then((function(e){w.update?a.mergeUpdates(w,e):w.addToStore("update",e),a.markLastUneadMessages(w,e),a.last_activity_date=e.data.last_activity_date,n&&n.triggerRenderFunc(),t&&t.changeButtonVisibility({isVisible:!0})})).catch((function(e){t&&(console.log("get updates errror "),t.changeButtonVisibility({isVisible:!1})),a.stopUpdatePoll(),console.log(e)}))},a.startUpdatePoll=function(e){e?(a.stopUpdatePoll(),a.pollInterval=e,a.pollIntervalObj=setInterval((function(){a.getUpdates(a.getLastActivityDate())}),e)):console.error("error null val for 'seconds'")},a.getLastActivityDate=function(){return a.last_activity_date},a.stopUpdatePoll=function(){a.pollIntervalObj&&clearTimeout(a.pollIntervalObj)},a.state={},a.last_activity_date="1984-08-01T00:00:00.000Z",a}return Object(h.a)(t,e),t}(s.a.Component)),M=a(8),k=a(14),H=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={hits:[],isLoading:!1,error:null},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("h1",null,"Welcome"),s.a.createElement(k.b,{to:"/phone"},"  Login with phone"))}}]),t}(o.Component),T=a(266),P=a(265),I=a(37),D=function(e){var t=e.input,a=e.label,n=e.type,r=(e.value,e.placeholder),o=e.meta,l=o.touched,c=o.error;return s.a.createElement("div",null,s.a.createElement("label",null,a),s.a.createElement("div",null,s.a.createElement("input",Object.assign({className:"form-control"},t,{placeholder:r,type:n})),l&&c&&s.a.createElement("span",null,c)))},R=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.props.options,t=e.handleSubmit,a=e.fields,n=Object(P.a)({form:"RenderFieldWrapped"})((function(){return s.a.createElement("div",null,"  ",s.a.createElement("form",{onSubmit:t},a.map((function(e){return s.a.createElement("div",{key:e.name},s.a.createElement(T.a,{name:e.name,onChange:e.onChangeFun,component:D,type:"input",placeholder:e.placeholder,label:e.name}))})),s.a.createElement("input",{className:"btn btn-primary",type:"submit",value:"Submit"})))}));return s.a.createElement("div",null,s.a.createElement(I.a,{store:w},s.a.createElement(n,{options:e})))}}]),t}(s.a.Component),L=a(29),U=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){a.state.phone=e.target.value},a.sendPhoneNum=function(e){var t=this;v.doPost(g.URLS.AUTH.PHONE,{phone:e},{}).then((function(){p[g.PHONE_HEADER_NAME]=e,t.props.history.push("/confirm-token")})).catch((function(e){p[g.PHONE_HEADER_NAME]=null,console.error(e)}))},a.handleSubmit=function(e){e.preventDefault();var t=a.props.history,n=a.state.phone,r=p.getLocalStorage();a.isToUseCurrentSession(n)?(console.log("use current session:"),p[g.PHONE_HEADER_NAME]=n,p[g.AUTH_HEADER_NAME]=r[n][g.AUTH_HEADER_NAME],f.applySettingsFromLocalStorage(),A.checkIfLogged({},(function(){t.push("/user")}),(function(){t.push("/confirm-token")}))):(console.log("do not use current session:"),p[g.PHONE_HEADER_NAME]=n,r&&r[n]&&r[n][g.AUTH_HEADER_NAME]&&(delete r[n][g.AUTH_HEADER_NAME],p.setLocalStorage(r),f.applySettingsFromLocalStorage()),a.sendPhoneNum(n))},a.isToUseCurrentSession=function(e){var t=p.getLocalStorage();return!(!t[e]||!t[e][g.AUTH_HEADER_NAME])&&window.confirm("A session with this phone numer: "+e+" already exists.\nUse current session?")},a.state={phone:""},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e={handleSubmit:this.handleSubmit,fields:[{name:"Phone number",placeholder:"Please, fill in ur phone number",onChangeFun:this.handleChange}]};return s.a.createElement("div",null,s.a.createElement(R,{options:e}))}}]),t}(s.a.Component),x=Object(L.f)(U),F=a(55),B=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChange=function(e){a.state.confirmToken=e.target.value},a.handleSubmit=function(e){e.preventDefault();var t=p[g.PHONE_HEADER_NAME];if(!t)throw new Error("CashService[Const.PHONE_HEADER_NAME] is not allowed to be "+t);var n=a.props.history,r=p.getLocalStorage();v.doGet(g.URLS.AUTH.GET_TOKEN+a.state.confirmToken+"/"+t).then((function(e){if(console.log(e),e&&200===e.status&&e.data){var a=e.data[g.AUTH_HEADER_NAME];r[t]||(r[t]={});var o=Object(F.a)({},g.AUTH_HEADER_NAME,a);A.checkIfLogged(o,(function(){r[t][g.AUTH_HEADER_NAME]=a,p.setLocalStorage(r),p[g.AUTH_HEADER_NAME]=a,n.push("/user")}),(function(){n.push("/phone")}))}})).catch((function(e){console.log(e)}))},a.state={confirmToken:""},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e={handleSubmit:this.handleSubmit,fields:[{name:"Confirmation code",placeholder:"Please, enter your confirmation code:",onChangeFun:this.handleChange}]};return s.a.createElement("div",null,s.a.createElement(R,{options:e}))}}]),t}(s.a.Component),V=Object(L.f)(B),G=a(120),W=a.n(G),z=(a(40),a(20)),J=a.n(z);var q=function(e){var t=e.person,a=t.pos_info&&t.pos_info.country?t.pos_info.country.name:"",n=t.birth_date?t.birth_date.substring(0,4):"",r=t.pos_info&&t.pos_info.city?t.pos_info.city.name:"";return s.a.createElement("div",{className:"text-justify text-wrap"},t.name?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Name:  ")," ",t.name," "):null,t.birth_date?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Date of Birth:  ")," ",n," "):null,t.distance_mi?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Distance (miles):  ")," ",t.distance_mi," "):null,t.pos_info?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Location:  ")," ",r,", ",a,"  "):null,t.bio?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Bio:  ")," ",t.bio," "):null,t.education?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Job:  ")," ",t.education," "):null,t.job?s.a.createElement("div",null," ",s.a.createElement("span",{className:"font-weight-bold"},"Job:  ")," ",t.job," "):null)},K=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).click=function(){a.isToShowPhotos&&(a.state.photos.length<2||(a.ind<a.state.photos.length-1?a.ind++:a.ind=0,a.setState({imgSrc:a.state.photos[a.ind].url})))};var n=a.props,r=n.photos,o=n.name;a.personName=o,a.isToShowPhotos=f.isToShowPhotos,a.ind=0;var s=a.isToShowPhotos?r[a.ind].url:null;return a.state={photos:r,imgSrc:s},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.isToShowPhotos?s.a.createElement("div",{className:"container-fluid px-0"},s.a.createElement("img",{onClick:this.click,src:this.state.imgSrc,alt:"some image",className:"img-fluid w-100"})):s.a.createElement("div",null,s.a.createElement("label",{className:"text-center"},this.personName," "))}}]),t}(s.a.Component),X=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={profile:a.props.data.profile.data,hits:[],isLoading:!1,error:null},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.state.profile,t=e.pos?[e.pos.lat,e.pos.lon]:[0,0],a=[{image:s.a.createElement(K,{photos:e.photos,name:e.name}),info:s.a.createElement(q,{person:e})}],n=[t],r={banner:!1,control:{values:n,onClick:function(e){n=[e],r.control.values=[e],console.log(n),function(e){var t={lat:e[0],lon:e[1]};v.doPost(g.URLS.SEND_LOCATION,t,{})}(e)},onRemove:function(e){return console.log("I've just been clicked for removal :(",e)}}},o={bindMap:!0,startPort:"default",overlayAll:!0,showControls:!1,showInputs:!1,useDynamic:!0,pointMode:r,precision:6};return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(J.a,{data:a,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:1,showPagination:!1,style:{width:"100%",height:"30%"},getTdProps:function(e,t,a,n){return{onClick:function(e,t){t&&t()}}}}),s.a.createElement("br",null)),s.a.createElement(W.a,o))}}]),t}(s.a.Component),Z=Object(L.f)(X),$=a(36),Q=new(function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(u.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).getUserData=function(e,t){var a=e.person._id;v.doGet(g.URLS.USER+a,{}).then((function(a){e.user=a.data.results,e.person.distance_mi=a.data.results.distance_mi,t(e)})).catch((function(e){console.error(e)}))},a}return Object(h.a)(t,e),t}(s.a.Component)),Y=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).doClick=function(e){a.changeHandler(e,a.match)},a.state={imgSrc:e.src},a.condition=e.condition,a.changeHandler=e.changeHandler,a.match=e.match,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentWillUnmount",value:function(){}},{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return this.condition?s.a.createElement("div",{className:"container-fluid px-0"},s.a.createElement("img",{onClick:this.doClick,src:this.state.imgSrc,alt:"new",className:"img-fluid w-100"})):s.a.createElement("div",{onClick:this.doClick},s.a.createElement("label",{className:"text-center"},this.match.person.name))}}]),t}(s.a.Component),ee=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).sortByLastActivityDate=function(e,t){var a=new Date(e.last_activity_date).getTime();return new Date(t.last_activity_date).getTime()-a},a.applySorting=function(e,t){try{e.sort(t)}catch(a){console.error(a)}return e},a.getUserData=function(e,t){Q.getUserData(t,(function(e){a.props.history.push({pathname:"/friend",state:{args:e}})}))},a.state={showUser:!1,isVisible:!1,msgMatches:[],sortingFunc:a.sortByLastActivityDate},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=w.getStore().update.data.matches;this.applySorting(t,this.state.sortingFunc);var a=t.map((function(t){var a,n=t.person;if(n){var r={condition:f.isToShowPhotos,src:n.photos[0].url,match:t,changeHandler:e.getUserData};a={firstName:n.name,lastName:n.birth_date,image:s.a.createElement(Y,r)}}return Object($.a)({},a)}));return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(J.a,{className:"-striped -highlight",data:a,columns:[{columns:[{Header:"Image",accessor:"image"},{Header:"First Name",accessor:"firstName"}]}],defaultPageSize:a.length,pageSize:a.length,sortable:!1,showPagination:!1}),s.a.createElement("br",null)))}}]),t}(s.a.Component),te=Object(L.f)(ee);var ae=function(e){return s.a.createElement("div",null,s.a.createElement(k.b,{to:{pathname:e.pathname,state:{data:e.data}}},s.a.createElement("button",{type:"button",className:"btn btn-primary"},e.label)))},ne=function(e){function t(){return Object(i.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this.props.location.state.args,t=[{image:s.a.createElement(K,{photos:e.person.photos,name:e.person.name}),info:s.a.createElement((function(){return s.a.createElement("div",null,s.a.createElement(ae,{label:"Chat",data:e,pathname:"/chat"}),s.a.createElement(q,{person:e.person}))}),null)}];return s.a.createElement("div",null,s.a.createElement("div",null,s.a.createElement(J.a,{data:t,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:1,showPagination:!1}),s.a.createElement("br",null)))}}]),t}(s.a.Component),re=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).getNewFriends=function(){v.doGet(g.URLS.NEW_FRIENDS,{}).then((function(e){var t=e.data.results;a.setState({allFr:t})})).catch((function(e){console.log(e)}))},a.pass=function(e){v.doGet(g.URLS.PASS+e,{}).then((function(e){})).catch((function(e){console.log(e)}))},a.like=function(e){v.doGet(g.URLS.LIKE+e,{}).then((function(e){console.log(e)})).catch((function(e){console.log(e)}))},a.state={allFr:[]},a.abortController=new AbortController,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){this.getNewFriends()}},{key:"render",value:function(){var e=this,t=function(t){var a=t.person;return s.a.createElement("div",{className:"text-justify text-wrap"},s.a.createElement("div",null,s.a.createElement("button",{type:"button",className:"btn btn-success",onClick:function(){return e.like(a._id)}}," Like "),s.a.createElement("button",{type:"button",className:"btn btn-danger ml-2",onClick:function(){return e.pass(a._id)}}," Pass ")),s.a.createElement(q,{person:a}))},a=function(e){return s.a.createElement(K,{photos:e.photos,name:e.name})},n=this.state.allFr.map((function(e){var n={info:s.a.createElement(t,{person:e}),image:s.a.createElement(a,{photos:e.photos,name:e.name})};return Object($.a)({},n)}));return s.a.createElement("div",null,s.a.createElement("div",{className:"text-justify text-center"},s.a.createElement(ae,{label:"Friend Requests",data:null,pathname:"/pal-requests"}),s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.getNewFriends}," Reload ")),s.a.createElement("div",null,s.a.createElement(J.a,{className:"-striped -highlight",data:n,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:n.length,pageSize:n.length,showPagination:!1}),s.a.createElement("br",null)))}}]),t}(s.a.Component),oe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).getFriendRequests=function(){v.doGet(g.URLS.FAST_MATCH,{}).then((function(e){e&&e.data&&e.data.data&&e.data.data.results&&a.setState({allFr:e.data.data.results})})).catch((function(e){console.log(e)}))},a.state={allFr:[],hits:[],isLoading:!1,error:null},a.abortController=new AbortController,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentWillUnmount",value:function(){this.abortController.abort()}},{key:"componentDidMount",value:function(){this.getFriendRequests()}},{key:"render",value:function(){var e=this,t=function(e){return s.a.createElement("div",{className:"text-justify text-wrap"}," ",e.info," ")},a=function(e){return s.a.createElement(K,{photos:e.photos})},n=this.state.allFr.map((function(e){var n={info:s.a.createElement(t,{info:e.user._id}),image:s.a.createElement(a,{photos:e.user.photos})};return Object($.a)({},n)}));return s.a.createElement("div",null,s.a.createElement("div",{className:"text-center p-1 "},s.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:function(){return e.getFriendRequests()}}," Reload ")),s.a.createElement("div",null,s.a.createElement(J.a,{className:"-striped -highlight",data:n,columns:[{columns:[{Header:"Photos",accessor:"image"},{Header:"Info",accessor:"info"}]}],sortable:!1,defaultPageSize:n.length,pageSize:n.length,showPagination:!1,style:{width:"100%",height:"30%"}}),s.a.createElement("br",null)))}}]),t}(s.a.Component),se=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).changeHandler=function(e){a.setState({interval:e.target.value}),f.updatePollInterval=e.target.value,a.props.onSelectPollInterval(e.target.value)},a.state={interval:f.updatePollInterval},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("form",null,s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Poll interval for getting updates to be every:"),s.a.createElement("select",{className:this.props.styles,value:this.state.interval,onChange:this.changeHandler},s.a.createElement("option",{value:"10000"},"10 sec"),s.a.createElement("option",{value:"20000"},"20 sec"),s.a.createElement("option",{value:"40000"},"40 sec"),s.a.createElement("option",{value:"50000"},"50 sec"),s.a.createElement("option",{value:"60000"},"1 min"),s.a.createElement("option",{value:"300000"},"5 min"),s.a.createElement("option",{value:"600000"},"10 min"))))}}]),t}(o.Component),le=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).changeHandler=function(e){var t=e.target.value;f.applyClass(document.body,f.textColors,t),f.persistSetting("textColor",t),a.setState({selected:t}),a.props.triggerRender()},a.state={selected:f.getSetting("textColor")||f.textColors[0]},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("form",null,s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Select text color:"),s.a.createElement("select",{className:this.props.styles,value:this.state.selected,onChange:this.changeHandler},f.textColors.map((function(e){return s.a.createElement("option",{key:e.name,value:e.class},e.name)})))))}}]),t}(o.Component),ce=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).changeHandler=function(e){var t=e.target.value;f.applyClass(document.body,f.bgColors,t),f.persistSetting("bgColor",t),a.setState({selected:t}),a.props.triggerRender()},a.state={selected:f.getSetting("bgColor")||f.bgColors[0]},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("form",null,s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Select background color:"),s.a.createElement("select",{className:this.props.styles,value:this.state.selected,onChange:this.changeHandler},f.bgColors.map((function(e){return s.a.createElement("option",{key:e.name,value:e.class},e.name)})))))}}]),t}(o.Component),ie=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).doChangeState=function(e){a.changeHandler(e),a.setState({condition:e.target.checked})},a.state={condition:e.condition},a.changeHandler=e.changeHandler,a.defaultChecked=e.defaultChecked,a.label=e.label,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"form-check"},s.a.createElement("input",{className:"form-check-input",type:"checkbox",checked:this.state.condition,onChange:this.doChangeState}),s.a.createElement("label",{className:"form-check-label"}," ",this.label," "))}}]),t}(o.Component),ue=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).onSelectPollInterval=function(e){A.startUpdatePoll(e),a.setState({pollInterval:e})},a.triggerRender=function(){a.setState({styles:f.getInputStyleClasses()})},a.toggleShowPicsCheckbox=function(e){f.isToShowPhotos=e.target.checked,a.setState({isToShowPhotos:f.isToShowPhotos})},a.state={styles:f.getInputStyleClasses(),isToShowPhotos:f.isToShowPhotos},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(se,{styles:this.state.styles,onSelectPollInterval:this.onSelectPollInterval}),s.a.createElement(ce,{styles:this.state.styles,triggerRender:this.triggerRender}),s.a.createElement(le,{styles:this.state.styles,triggerRender:this.triggerRender}),s.a.createElement(ie,{label:"show photos",condition:this.state.isToShowPhotos,changeHandler:this.toggleShowPicsCheckbox}))}}]),t}(s.a.Component),me=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).changeState=function(e){a.setState(e)},a.addMsgMatch=function(e){if(!(a.findInMsgMatches(e)>-1)){var t=a.state.msgMatches;a.state.msgMatches.push(e),a.setState({msgMatches:t}),a.toggleFlashTabTitle()}},a.findInMsgMatches=function(e){for(var t=a.state.msgMatches,n=0,r=t.length;n<r;n++)if(t[n].id===e.id)return n;return-1},a.removeMsgMatch=function(e){var t=a.findInMsgMatches(e);if(t>-1){var n=a.state.msgMatches;n.splice(t,1),a.setState({msgMatches:n}),a.toggleFlashTabTitle()}},a.changeButtonVisibility=function(e){a.setState(e)},a.toggleFlashTabTitle=function(){a.state.msgMatches.length>0&&!a.flashIntervalObj?a.startFlashTabTitle():a.stopFlashTabTitle()},a.startFlashTabTitle=function(){a.flashIntervalObj=setInterval((function(){a.initialTitle===document.title?document.title="("+a.state.msgMatches.length+") "+a.initialTitle:document.title=a.initialTitle}),1e3)},a.stopFlashTabTitle=function(){clearTimeout(a.flashIntervalObj),a.flashIntervalObj=null,document.title=a.initialTitle},a.getUserData=function(e){Q.getUserData(e,(function(e){a.props.history.push({pathname:"/friend",state:{args:e}})}))},a.goChat=function(e){a.props.history.push({pathname:"/chat",state:{data:e}})},a.state={beanId:e.beanId,showUser:!1,isVisible:!1,msgMatches:[]},a.initialTitle=document.title,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){S.add(this)}},{key:"componentWillUnmount",value:function(){S.remove(this)}},{key:"render",value:function(){var e=this,t=function(e){return s.a.createElement("div",null,s.a.createElement(k.c,{exact:!0,activeClassName:"active",to:e.to},s.a.createElement("button",{type:"button",className:"btn btn-primary"},e.label)))},a=!!this.state.msgMatches.length;return s.a.createElement("div",{className:"text-center "},s.a.createElement("nav",null,s.a.createElement("div",{className:"btn-group"},this.state.isVisible?null:s.a.createElement(t,{to:"/home",label:"Home"}),this.state.isVisible?s.a.createElement(t,{to:"/user",label:"User"}):null,this.state.isVisible?s.a.createElement(t,{to:"/pals",label:"Pals"}):null,this.state.isVisible?s.a.createElement(t,{to:"/more-pals",label:"More Pals"}):null,this.state.isVisible?s.a.createElement(t,{to:"/settings",label:"Settings"}):null,this.state.isVisible?s.a.createElement(t,{to:"/logout",label:"|->"}):null,this.state.isVisible&&a?s.a.createElement((function(t){var a=t.data;return a.messages&&0!=a.messages.length?s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){return e.goChat(a)},className:"btn btn-primary"},"New: ",e.state.msgMatches.length," ")):s.a.createElement("div",null,s.a.createElement("button",{onClick:function(){e.removeMsgMatch(a),e.getUserData(a)},className:"btn btn-primary"},"New: ",e.state.msgMatches.length," "))}),{data:this.state.msgMatches[0]}):null)))}}]),t}(s.a.Component),he=Object(L.f)(me),de=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).createMessage=function(e,t){var n=new Date;return{created_date:n.toISOString(),from:t.profile.data._id,match_id:e.id,message:a.state.value,sent_date:n.toISOString(),timestamp:n.getTime(),to:e.person._id}},a.onKeyPress=function(e){if("Enter"===e.key){for(var t=w.update.data.matches,n=0;n<t.length;n++){var r=t[n];if(r.person._id===a.state.friendId){var o=a.createMessage(r,a.state.store);v.doPost(g.URLS.SEND_MESSAGE,o,{}),w.update.data.matches[n].messages.push(o),a.state.triggerRenderFunc();break}}a.setState({value:""})}},a.onChange=function(e){var t=e.srcElement||e.target;a.setState({value:t.value})},a.state={value:"",store:e.data,friendId:e.friendId,triggerRenderFunc:e.triggerRenderFunc},a.getStyles=f.getInputStyleClasses,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e={placeholder:"Write...",value:this.state.value,onChange:this.onChange,className:this.getStyles(),onKeyPress:this.onKeyPress};return s.a.createElement("div",null,s.a.createElement("input",Object.assign({},e,{type:"text"})))}}]),t}(s.a.Component),ge=function(e){function t(e){var a;Object(i.a)(this,t);var n=(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).props.msg,r=new Date(n.timestamp),o=r.toLocaleTimeString(),s=r.toLocaleDateString();return s!==(new Date).toLocaleDateString()&&(o=o+",  "+s),a.state={isSeen:n.isSeen,showDate:!1,date:o},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){var e=this,t=this.props.msg;return s.a.createElement("div",{onClick:function(){e.setState({showDate:!0}),setTimeout((function(){e.setState({showDate:!1})}),5e3)}},s.a.createElement("p",{className:"text-justify text-wrap"},"  ",t.message," "),this.state.isSeen?s.a.createElement("span",{className:"badge badge-secondary text-justify text-wrap"},"seen"):null,this.state.showDate?s.a.createElement("span",{className:"badge small"},"  ",this.state.date," "):null)}}]),t}(s.a.Component),pe=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).changeHandler=function(e){var t=S.get("chat1");a.setState({numberMsgShown:e.target.value}),t&&t.changeState({numberMsgShown:parseInt(e.target.value)})},a.state={numberMsgShown:10,getStyles:e.getStyles},a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"render",value:function(){return s.a.createElement("form",null,s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Number of messages to show:"),s.a.createElement("select",{className:this.state.getStyles(),value:this.state.numberMsgShown,onChange:this.changeHandler},s.a.createElement("option",{value:"10"},"10"),s.a.createElement("option",{value:"20"},"20"),s.a.createElement("option",{value:"50"},"50"),s.a.createElement("option",{value:"70"},"70"))))}}]),t}(o.Component),fe=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).prepareMessages=function(e,t,a){var n=[];n.length=a;for(var r=e.length-1;0<=a;a--,r--){var o=e[r];o||(o={});var l={};n[a]=l,o.from===t?l.theirs=s.a.createElement(ge,{msg:o}):l.mine=s.a.createElement(ge,{msg:o})}return n},a.triggerRenderFunc=function(){var e=w.getMatchById(a.state.match._id),t=e.seen?e.seen.last_seen_msg_id:null;a.setState({lastSeenMsg:t,match:e,messages:e.messages})},a.changeState=function(e){a.setState(e)},a.sendSeen=function(e){if(a.state.lastSeenMsg||console.log("empty value of 'lastSeenMsg'.."),e&&e.length)for(var t=e.length-1;0<=t;t--){var n=e[t];if(n&&n.theirs){var r=n.theirs.props.msg;if(r._id!==a.state.lastSeenMsg){v.doGet(g.URLS.SEND_SEEN+r.match_id+"/"+r._id,{});var o=a.state.match;return o.seen&&(o.seen.last_seen_msg_id=r._id),void a.deleteFromHeader()}if(n.theirs)break}}else a.deleteFromHeader()},a.deleteFromHeader=function(){var e=S.get("header1");e&&e.removeMsgMatch(a.state.match)},console.log(e);var n=e.location.state.data,r=n.person._id,o=n.seen?n.seen.last_seen_msg_id:null;return a.state={lastSeenMsg:o,numberMsgShown:10,matchId:n.id,store:w,match:n,friendId:r,messages:n.messages},a.inputStyles=f.getInputStyleClasses,a}return Object(h.a)(t,e),Object(M.a)(t,[{key:"componentDidMount",value:function(){S.add(this)}},{key:"componentWillUnmount",value:function(){S.remove(this)}},{key:"render",value:function(){var e=[{columns:[{Header:this.state.match.person.name,accessor:"theirs"},{Header:"Me",accessor:"mine"}]}],t=this.prepareMessages(this.state.messages,this.state.friendId,this.state.numberMsgShown);this.sendSeen(t);var a={data:this.state.store,friendId:this.state.match.person._id,triggerRenderFunc:this.triggerRenderFunc};return s.a.createElement("div",null,s.a.createElement(pe,{getStyles:this.inputStyles}),s.a.createElement("div",null,s.a.createElement(J.a,{data:t,columns:e,defaultPageSize:t.length,pageSize:t.length,showPagination:!1,bordered:!1,sortable:!1}),s.a.createElement("div",null,s.a.createElement(de,a)),s.a.createElement("br",null)))}}]),t}(s.a.Component),be=Object(L.f)(fe),Ee=function(){return s.a.createElement("div",{className:"container",style:{paddingTop:10}},s.a.createElement(k.a,null,s.a.createElement(he,{beanId:"header1"}),s.a.createElement(L.c,null,s.a.createElement(L.a,{exact:!0,path:"/",component:H}),s.a.createElement(L.a,{path:"/user",render:function(){return s.a.createElement(Z,{data:w})}}),s.a.createElement(L.a,{path:"/phone",component:x}),s.a.createElement(L.a,{path:"/friend",component:ne}),s.a.createElement(L.a,{path:"/chat",render:function(){return s.a.createElement(be,{beanId:"chat1"})}}),s.a.createElement(L.a,{path:"/pals",render:function(){return s.a.createElement(te,{data:w.updates})}}),s.a.createElement(L.a,{path:"/more-pals",render:function(){return s.a.createElement(re,{data:w.updates})}}),s.a.createElement(L.a,{path:"/pal-requests",render:function(){return s.a.createElement(oe,{data:w.updates})}}),s.a.createElement(L.a,{path:"/settings",render:function(){return s.a.createElement(ue,{beanId:"appSettings1"})}}),s.a.createElement(L.a,{path:"/confirm-token",component:V}),s.a.createElement(L.a,{path:"*",component:H}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(263);c.a.render(s.a.createElement(Ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[122,1,2]]]);
//# sourceMappingURL=main.2ac978cc.chunk.js.map